# 管理后台菜单重构 - 需求文档

## 简介

优化管理后台的菜单结构，将"网站配置"和"充值配置"整合到"系统设置"下作为子菜单，提供更清晰的导航层次和更好的用户体验。

## 术语表

- **管理后台 (Admin Dashboard)**: 管理员使用的后台管理系统
- **菜单项 (Menu Item)**: 侧边栏中的导航链接
- **子菜单 (Submenu)**: 可展开/收起的二级菜单
- **系统设置 (System Settings)**: 包含各种配置选项的父级菜单
- **网站配置 (Site Config)**: 网站基本信息、联系方式等配置
- **充值配置 (Recharge Config)**: 充值套餐、支付方式等配置

---

## 需求

### 需求1: 菜单结构优化

**用户故事**: 作为管理员，我希望相关的配置选项能够分组显示，这样我可以更快地找到需要的功能。

#### 验收标准

1. WHEN 管理员访问管理后台，THE 系统 SHALL 在侧边栏显示"系统设置"菜单项
2. WHEN 管理员点击"系统设置"菜单项，THE 系统 SHALL 展开显示子菜单列表
3. THE 系统设置子菜单 SHALL 包含以下选项：
   - 网站配置
   - 充值配置
   - 系统参数（预留）
4. WHEN 管理员点击子菜单项，THE 系统 SHALL 导航到对应的配置页面
5. WHEN 管理员在某个子菜单页面时，THE 系统 SHALL 保持"系统设置"菜单展开状态并高亮当前子菜单项

### 需求2: 菜单展开/收起交互

**用户故事**: 作为管理员，我希望能够展开和收起菜单分组，这样我可以更好地管理屏幕空间。

#### 验收标准

1. WHEN 管理员点击带有子菜单的菜单项，THE 系统 SHALL 切换该菜单的展开/收起状态
2. WHEN 子菜单展开时，THE 系统 SHALL 显示向下的箭头图标
3. WHEN 子菜单收起时，THE 系统 SHALL 显示向右的箭头图标
4. WHEN 管理员刷新页面，THE 系统 SHALL 根据当前路由自动展开相应的父级菜单
5. THE 展开/收起动画 SHALL 流畅且持续时间不超过300毫秒

### 需求3: 视觉层次区分

**用户故事**: 作为管理员，我希望能够清楚地区分父级菜单和子菜单，这样我可以快速理解菜单结构。

#### 验收标准

1. THE 子菜单项 SHALL 相对于父级菜单项向右缩进16像素
2. THE 子菜单项文字大小 SHALL 比父级菜单项小（父级14px，子级13px）
3. THE 子菜单项背景色 SHALL 使用更浅的颜色以示区分
4. WHEN 子菜单项被激活时，THE 系统 SHALL 同时高亮父级菜单项和当前子菜单项
5. THE 父级菜单项 SHALL 在有子菜单展开时显示不同的背景色

### 需求4: 移动端适配

**用户故事**: 作为使用移动设备的管理员，我希望菜单在小屏幕上也能正常工作，这样我可以在任何设备上管理系统。

#### 验收标准

1. WHEN 管理员在移动设备上打开侧边栏，THE 系统 SHALL 正确显示带子菜单的菜单结构
2. WHEN 管理员点击父级菜单项，THE 系统 SHALL 展开子菜单而不是关闭侧边栏
3. WHEN 管理员点击子菜单项，THE 系统 SHALL 导航到对应页面并关闭侧边栏
4. THE 子菜单展开/收起动画 SHALL 在移动设备上流畅运行

### 需求5: 路由和导航保持

**用户故事**: 作为管理员，我希望页面URL能够反映当前的位置，这样我可以收藏或分享特定的配置页面。

#### 验收标准

1. THE 网站配置页面路由 SHALL 保持为 `/admin/site-config`
2. THE 充值配置页面路由 SHALL 保持为 `/admin/recharge-config`
3. WHEN 管理员直接访问配置页面URL，THE 系统 SHALL 自动展开对应的父级菜单
4. WHEN 管理员使用浏览器后退按钮，THE 系统 SHALL 正确更新菜单状态
5. THE 面包屑导航（如果存在）SHALL 显示完整的导航路径

### 需求6: 菜单状态持久化

**用户故事**: 作为管理员，我希望系统能记住我的菜单展开状态，这样我不需要每次都重新展开菜单。

#### 验收标准

1. WHEN 管理员展开或收起菜单，THE 系统 SHALL 将状态保存到 localStorage
2. WHEN 管理员刷新页面，THE 系统 SHALL 恢复之前的菜单展开状态
3. WHEN 管理员在不同浏览器标签页之间切换，THE 系统 SHALL 保持一致的菜单状态
4. THE 菜单状态 SHALL 以 JSON 格式存储在 localStorage 的 `adminMenuState` 键中

### 需求7: 无障碍访问

**用户故事**: 作为使用辅助技术的管理员，我希望能够通过键盘操作菜单，这样我可以高效地导航系统。

#### 验收标准

1. WHEN 管理员使用 Tab 键，THE 系统 SHALL 按顺序聚焦菜单项
2. WHEN 管理员在父级菜单项上按 Enter 或 Space 键，THE 系统 SHALL 切换子菜单展开状态
3. WHEN 管理员在子菜单项上按 Enter 键，THE 系统 SHALL 导航到对应页面
4. THE 菜单项 SHALL 包含适当的 ARIA 属性（aria-expanded, aria-label）
5. THE 屏幕阅读器 SHALL 能够正确朗读菜单结构和当前状态

---

## 当前菜单结构

```
- 仪表盘
- 用户管理
- 内容管理
- 提现管理
- 工单管理
- 通知管理
- 充值卡管理
- 网站配置        ← 需要移动
- 充值配置        ← 需要移动
- 系统设置        ← 需要改为父级菜单
```

## 目标菜单结构

```
- 仪表盘
- 用户管理
- 内容管理
- 提现管理
- 工单管理
- 通知管理
- 充值卡管理
- 系统设置 ▼     ← 可展开的父级菜单
  - 网站配置
  - 充值配置
  - 系统参数（预留）
```

---

## 非功能需求

### 性能
- 菜单展开/收起动画应在 60fps 下流畅运行
- localStorage 读写操作不应阻塞 UI 渲染
- 菜单状态更新应使用防抖处理，避免频繁写入

### 兼容性
- 支持 Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- 支持 iOS 14+ 和 Android 10+ 的移动浏览器
- 在不支持 localStorage 的环境中应优雅降级

### 可维护性
- 菜单配置应使用数据驱动的方式定义
- 子菜单组件应可复用
- 菜单状态管理应集中处理

---

## 约束条件

1. 不能破坏现有的路由结构
2. 必须保持与现有设计系统的一致性
3. 必须支持未来添加更多子菜单项
4. 必须在所有现有支持的设备上正常工作

---

## 验收测试场景

### 场景1: 基本导航
1. 访问管理后台
2. 点击"系统设置"
3. 验证子菜单展开
4. 点击"网站配置"
5. 验证导航到网站配置页面
6. 验证菜单保持展开状态

### 场景2: 刷新页面
1. 在网站配置页面刷新
2. 验证"系统设置"自动展开
3. 验证"网站配置"被高亮

### 场景3: 移动端操作
1. 在移动设备上打开侧边栏
2. 点击"系统设置"
3. 验证子菜单展开
4. 点击"充值配置"
5. 验证导航成功且侧边栏关闭

### 场景4: 键盘导航
1. 使用 Tab 键聚焦到"系统设置"
2. 按 Enter 键
3. 验证子菜单展开
4. 继续使用 Tab 键聚焦到"网站配置"
5. 按 Enter 键
6. 验证导航成功

---

## 优先级

- P0 (必须): 需求1, 需求2, 需求5
- P1 (重要): 需求3, 需求4
- P2 (可选): 需求6, 需求7

---

**创建日期**: 2025-10-22  
**状态**: 待审核
