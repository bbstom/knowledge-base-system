# 时区配置常见问题

## ❓ 时区配置会影响数据库存储的时间吗？

**答案：❌ 不会**

- MongoDB 存储的是 **UTC 时间戳**
- 时区配置只影响 **时间显示**
- 已存储的数据不会改变

## 📊 时间存储方式

### 数据库中的实际存储
```javascript
// 北京时间：2025-11-08 22:30:00
// 数据库存储：2025-11-08T14:30:00.000Z (UTC)
```

### 时区配置的作用
```
✅ 影响：前端显示的时间
✅ 影响：服务器日志时间
✅ 影响：console.log 输出
❌ 不影响：数据库存储
❌ 不影响：时间戳计算
```

## 🎯 实际示例

### 用户注册时间
```javascript
// 服务器时区：Asia/Shanghai (UTC+8)
// 注册时间：2025-11-08 22:30:00 (北京时间)

// 数据库存储
createdAt: ISODate("2025-11-08T14:30:00.000Z")  // UTC

// 在中国显示
2025-11-08 22:30:00  // UTC+8

// 在美国显示
2025-11-08 09:30:00  // UTC-5

// 在日本显示
2025-11-08 23:30:00  // UTC+9
```

## ⚠️ 注意事项

### 1. 时间查询
```javascript
// ❌ 错误：使用本地时间查询
const today = new Date();
today.setHours(0, 0, 0, 0);  // 受时区影响

// ✅ 正确：使用 UTC 时间查询
const today = new Date();
today.setUTCHours(0, 0, 0, 0);  // 不受时区影响
```

### 2. 时间显示
```javascript
// ✅ 推荐：在前端转换
date.toLocaleString('zh-CN', {
  timeZone: 'Asia/Shanghai'
});
```

### 3. 时区变更
```
修改时区配置后：
✅ 新显示的时间会使用新时区
❌ 数据库中的时间不会改变
⚠️ 需要重启服务器生效
```

## 💡 最佳实践

1. **存储**：始终使用 UTC 时间
2. **显示**：根据配置转换时区
3. **查询**：使用 UTC 时间避免错误
4. **迁移**：时区变更不影响数据

## 📚 详细文档

- [时区对数据库的影响](./TIMEZONE_DATABASE_IMPACT.md)
- [时区配置指南](./TIMEZONE_CONFIG_GUIDE.md)

---

**总结：** 时区配置是"显示层"的设置，不会改变"存储层"的数据。这是标准的最佳实践。
